<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedAsset Partners - Vendor Performance Scorecard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333333;
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #2E86AB 0%, #3498db 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.95;
        }

        .scorecard {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .vendor-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .info-group {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #2E86AB;
        }

        .info-group label {
            display: block;
            font-weight: 600;
            color: #333333;
            margin-bottom: 5px;
        }

        .info-group input, .info-group select, .info-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .info-group input:focus, .info-group select:focus, .info-group textarea:focus {
            outline: none;
            border-color: #2E86AB;
        }

        .category {
            margin-bottom: 30px;
            border: 1px solid #eeeeee;
            border-radius: 10px;
            overflow: hidden;
        }

        .category-header {
            background: linear-gradient(135deg, #2E86AB 0%, #A23B72 50%, #F18F01 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .category-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .category-score {
            font-size: 1.5rem;
            font-weight: bold;
            background: rgba(255,255,255,0.2);
            padding: 10px 15px;
            border-radius: 20px;
        }

        .criteria-list {
            padding: 0;
        }

        .criterion {
            padding: 20px;
            border-bottom: 1px solid #eeeeee;
            display: grid;
            grid-template-columns: 2fr 1fr 100px;
            gap: 20px;
            align-items: center;
            transition: background-color 0.3s;
        }

        .criterion:hover {
            background-color: #f8f9fa;
        }

        .criterion:last-child {
            border-bottom: none;
        }

        .criterion-text {
            color: #333333;
            font-weight: 500;
        }

        .criterion-description {
            font-size: 0.9rem;
            color: #666666;
            margin-top: 5px;
        }

        .rating-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .rating-select {
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            border-radius: 5px;
            background: white;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }

        .rating-select:focus {
            outline: none;
            border-color: #2E86AB;
        }

        .weight-input {
            width: 80px;
            padding: 8px;
            border: 2px solid #e9ecef;
            border-radius: 5px;
            text-align: center;
            font-weight: 500;
        }

        .score-display {
            font-size: 1.2rem;
            font-weight: bold;
            text-align: center;
            padding: 10px;
            border-radius: 5px;
            color: white;
            background: #666666;
        }

        .score-excellent { background: #27AE60; }
        .score-good { background: #F39C12; }
        .score-fair { background: #F18F01; }
        .score-poor { background: #E74C3C; }

        .summary {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .summary-item {
            text-align: center;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .summary-score {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .summary-label {
            color: #666666;
            font-weight: 500;
        }

        .recommendations {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #F18F01;
        }

        .recommendations h3 {
            color: #F18F01;
            margin-bottom: 15px;
        }

        .btn {
            background: linear-gradient(135deg, #F18F01 0%, #F39C12 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s;
            margin: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(241, 143, 1, 0.3);
        }

        .legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 10px;
            border: 1px solid #eeeeee;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }

        @media (max-width: 768px) {
            .criterion {
                grid-template-columns: 1fr;
                gap: 15px;
                text-align: center;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .container {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Vendor Performance Scorecard</h1>
            <p>Comprehensive evaluation tool for medical asset management providers</p>
        </div>

        <div class="scorecard">
            <div class="vendor-info">
                <div class="info-group">
                    <label for="vendorName">Vendor Name:</label>
                    <input type="text" id="vendorName" placeholder="Enter vendor name">
                </div>
                <div class="info-group">
                    <label for="evaluator">Evaluator:</label>
                    <input type="text" id="evaluator" placeholder="Your name/organization">
                </div>
                <div class="info-group">
                    <label for="evaluationDate">Evaluation Date:</label>
                    <input type="date" id="evaluationDate">
                </div>
                <div class="info-group">
                    <label for="facilityType">Facility Type:</label>
                    <select id="facilityType">
                        <option value="">Select facility type</option>
                        <option value="hospital">Hospital</option>
                        <option value="clinic">Clinic</option>
                        <option value="surgery-center">Surgery Center</option>
                        <option value="imaging-center">Imaging Center</option>
                        <option value="other">Other</option>
                    </select>
                </div>
            </div>

            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color score-excellent"></div>
                    <span>Excellent (4-5)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color score-good"></div>
                    <span>Good (3-3.9)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color score-fair"></div>
                    <span>Fair (2-2.9)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color score-poor"></div>
                    <span>Poor (1-1.9)</span>
                </div>
            </div>

            <!-- Service Quality & Expertise -->
            <div class="category">
                <div class="category-header">
                    <div class="category-title">Service Quality & Expertise</div>
                    <div class="category-score" id="category1Score">0.0</div>
                </div>
                <div class="criteria-list">
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Technical Expertise</div>
                            <div class="criterion-description">Knowledge of medical equipment, compliance requirements, and industry standards</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="1" data-criterion="1">
                                <option value="0">Select Rating</option>
                                <option value="5">Excellent (5)</option>
                                <option value="4">Good (4)</option>
                                <option value="3">Average (3)</option>
                                <option value="2">Below Average (2)</option>
                                <option value="1">Poor (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score1-1">0</div>
                    </div>
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Service Response Time</div>
                            <div class="criterion-description">Speed of initial response and issue resolution</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="1" data-criterion="2">
                                <option value="0">Select Rating</option>
                                <option value="5">< 2 hours (5)</option>
                                <option value="4">2-4 hours (4)</option>
                                <option value="3">4-8 hours (3)</option>
                                <option value="2">8-24 hours (2)</option>
                                <option value="1">> 24 hours (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score1-2">0</div>
                    </div>
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Certification & Training</div>
                            <div class="criterion-description">Staff qualifications, ongoing training, and industry certifications</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="1" data-criterion="3">
                                <option value="0">Select Rating</option>
                                <option value="5">Excellent (5)</option>
                                <option value="4">Good (4)</option>
                                <option value="3">Average (3)</option>
                                <option value="2">Below Average (2)</option>
                                <option value="1">Poor (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score1-3">0</div>
                    </div>
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Problem Resolution</div>
                            <div class="criterion-description">Effectiveness in diagnosing and fixing equipment issues</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="1" data-criterion="4">
                                <option value="0">Select Rating</option>
                                <option value="5">Excellent (5)</option>
                                <option value="4">Good (4)</option>
                                <option value="3">Average (3)</option>
                                <option value="2">Below Average (2)</option>
                                <option value="1">Poor (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score1-4">0</div>
                    </div>
                </div>
            </div>

            <!-- Cost & Value -->
            <div class="category">
                <div class="category-header">
                    <div class="category-title">Cost & Value</div>
                    <div class="category-score" id="category2Score">0.0</div>
                </div>
                <div class="criteria-list">
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Pricing Transparency</div>
                            <div class="criterion-description">Clear, upfront pricing with no hidden costs</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="2" data-criterion="1">
                                <option value="0">Select Rating</option>
                                <option value="5">Excellent (5)</option>
                                <option value="4">Good (4)</option>
                                <option value="3">Average (3)</option>
                                <option value="2">Below Average (2)</option>
                                <option value="1">Poor (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score2-1">0</div>
                    </div>
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Cost-Effectiveness</div>
                            <div class="criterion-description">Value provided relative to cost, ROI potential</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="2" data-criterion="2">
                                <option value="0">Select Rating</option>
                                <option value="5">Excellent (5)</option>
                                <option value="4">Good (4)</option>
                                <option value="3">Average (3)</option>
                                <option value="2">Below Average (2)</option>
                                <option value="1">Poor (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score2-2">0</div>
                    </div>
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Contract Flexibility</div>
                            <div class="criterion-description">Adaptable terms, easy modification, fair cancellation policies</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="2" data-criterion="3">
                                <option value="0">Select Rating</option>
                                <option value="5">Excellent (5)</option>
                                <option value="4">Good (4)</option>
                                <option value="3">Average (3)</option>
                                <option value="2">Below Average (2)</option>
                                <option value="1">Poor (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score2-3">0</div>
                    </div>
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Payment Terms</div>
                            <div class="criterion-description">Reasonable payment schedules and billing practices</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="2" data-criterion="4">
                                <option value="0">Select Rating</option>
                                <option value="5">Excellent (5)</option>
                                <option value="4">Good (4)</option>
                                <option value="3">Average (3)</option>
                                <option value="2">Below Average (2)</option>
                                <option value="1">Poor (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score2-4">0</div>
                    </div>
                </div>
            </div>

            <!-- Compliance & Safety -->
            <div class="category">
                <div class="category-header">
                    <div class="category-title">Compliance & Safety</div>
                    <div class="category-score" id="category3Score">0.0</div>
                </div>
                <div class="criteria-list">
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Regulatory Compliance</div>
                            <div class="criterion-description">FDA, Joint Commission, state regulations adherence</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="3" data-criterion="1">
                                <option value="0">Select Rating</option>
                                <option value="5">Excellent (5)</option>
                                <option value="4">Good (4)</option>
                                <option value="3">Average (3)</option>
                                <option value="2">Below Average (2)</option>
                                <option value="1">Poor (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score3-1">0</div>
                    </div>
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Documentation Quality</div>
                            <div class="criterion-description">Thorough, accurate maintenance and compliance records</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="3" data-criterion="2">
                                <option value="0">Select Rating</option>
                                <option value="5">Excellent (5)</option>
                                <option value="4">Good (4)</option>
                                <option value="3">Average (3)</option>
                                <option value="2">Below Average (2)</option>
                                <option value="1">Poor (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score3-2">0</div>
                    </div>
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Safety Protocols</div>
                            <div class="criterion-description">Adherence to safety standards and protocols</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="3" data-criterion="3">
                                <option value="0">Select Rating</option>
                                <option value="5">Excellent (5)</option>
                                <option value="4">Good (4)</option>
                                <option value="3">Average (3)</option>
                                <option value="2">Below Average (2)</option>
                                <option value="1">Poor (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score3-3">0</div>
                    </div>
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Insurance & Liability</div>
                            <div class="criterion-description">Adequate insurance coverage and liability protection</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="3" data-criterion="4">
                                <option value="0">Select Rating</option>
                                <option value="5">Excellent (5)</option>
                                <option value="4">Good (4)</option>
                                <option value="3">Average (3)</option>
                                <option value="2">Below Average (2)</option>
                                <option value="1">Poor (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score3-4">0</div>
                    </div>
                </div>
            </div>

            <!-- Communication & Reliability -->
            <div class="category">
                <div class="category-header">
                    <div class="category-title">Communication & Reliability</div>
                    <div class="category-score" id="category4Score">0.0</div>
                </div>
                <div class="criteria-list">
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Communication Quality</div>
                            <div class="criterion-description">Clear, timely, professional communication</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="4" data-criterion="1">
                                <option value="0">Select Rating</option>
                                <option value="5">Excellent (5)</option>
                                <option value="4">Good (4)</option>
                                <option value="3">Average (3)</option>
                                <option value="2">Below Average (2)</option>
                                <option value="1">Poor (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score4-1">0</div>
                    </div>
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Availability & Scheduling</div>
                            <div class="criterion-description">Flexible scheduling and emergency availability</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="4" data-criterion="2">
                                <option value="0">Select Rating</option>
                                <option value="5">24/7 Emergency (5)</option>
                                <option value="4">Extended Hours (4)</option>
                                <option value="3">Business Hours+ (3)</option>
                                <option value="2">Business Hours (2)</option>
                                <option value="1">Limited Hours (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score4-2">0</div>
                    </div>
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Project Management</div>
                            <div class="criterion-description">Organization, timeline adherence, project coordination</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="4" data-criterion="3">
                                <option value="0">Select Rating</option>
                                <option value="5">Excellent (5)</option>
                                <option value="4">Good (4)</option>
                                <option value="3">Average (3)</option>
                                <option value="2">Below Average (2)</option>
                                <option value="1">Poor (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score4-3">0</div>
                    </div>
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Follow-up & Support</div>
                            <div class="criterion-description">Post-service follow-up and ongoing support quality</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="4" data-criterion="4">
                                <option value="0">Select Rating</option>
                                <option value="5">Excellent (5)</option>
                                <option value="4">Good (4)</option>
                                <option value="3">Average (3)</option>
                                <option value="2">Below Average (2)</option>
                                <option value="1">Poor (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score4-4">0</div>
                    </div>
                </div>
            </div>

            <!-- Technology & Innovation -->
            <div class="category">
                <div class="category-header">
                    <div class="category-title">Technology & Innovation</div>
                    <div class="category-score" id="category5Score">0.0</div>
                </div>
                <div class="criteria-list">
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Technology Integration</div>
                            <div class="criterion-description">Modern tools, software, and digital capabilities</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="5" data-criterion="1">
                                <option value="0">Select Rating</option>
                                <option value="5">Cutting-edge (5)</option>
                                <option value="4">Modern (4)</option>
                                <option value="3">Standard (3)</option>
                                <option value="2">Basic (2)</option>
                                <option value="1">Outdated (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score5-1">0</div>
                    </div>
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Equipment & Tools</div>
                            <div class="criterion-description">Quality and modernity of service equipment and tools</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="5" data-criterion="2">
                                <option value="0">Select Rating</option>
                                <option value="5">Excellent (5)</option>
                                <option value="4">Good (4)</option>
                                <option value="3">Average (3)</option>
                                <option value="2">Below Average (2)</option>
                                <option value="1">Poor (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score5-2">0</div>
                    </div>
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Reporting & Analytics</div>
                            <div class="criterion-description">Quality of reporting, data insights, and analytics provided</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="5" data-criterion="3">
                                <option value="0">Select Rating</option>
                                <option value="5">Excellent (5)</option>
                                <option value="4">Good (4)</option>
                                <option value="3">Average (3)</option>
                                <option value="2">Below Average (2)</option>
                                <option value="1">Poor (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score5-3">0</div>
                    </div>
                    <div class="criterion">
                        <div>
                            <div class="criterion-text">Innovation & Improvement</div>
                            <div class="criterion-description">Continuous improvement efforts and innovative solutions</div>
                        </div>
                        <div class="rating-group">
                            <select class="rating-select" data-category="5" data-criterion="4">
                                <option value="0">Select Rating</option>
                                <option value="5">Excellent (5)</option>
                                <option value="4">Good (4)</option>
                                <option value="3">Average (3)</option>
                                <option value="2">Below Average (2)</option>
                                <option value="1">Poor (1)</option>
                            </select>
                        </div>
                        <div class="score-display" id="score5-4">0</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="summary">
            <h2 style="text-align: center; margin-bottom: 30px; color: #333333;">Performance Summary</h2>
            <div class="summary-grid">
                <div class="summary-item">
                    <div class="summary-score" id="overallScore" style="color: #2E86AB;">0.0</div>
                    <div class="summary-label">Overall Score</div>
                </div>
                <div class="summary-item">
                    <div class="summary-score" id="highestCategory" style="color: #27AE60;">--</div>
                    <div class="summary-label">Highest Category</div>
                </div>
                <div class="summary-item">
                    <div class="summary-score" id="lowestCategory" style="color: #E74C3C;">--</div>
                    <div class="summary-label">Lowest Category</div>
                </div>
                <div class="summary-item">
                    <div class="summary-score" id="totalCriteria" style="color: #8E44AD;">20</div>
                    <div class="summary-label">Total Criteria</div>
                </div>
            </div>

            <div class="recommendations">
                <h3>Recommendations & Notes</h3>
                <textarea id="recommendations" rows="4" placeholder="Add your recommendations, concerns, or additional notes about this vendor..."></textarea>
            </div>

            <div style="text-align: center; margin-top: 30px;">
                <button class="btn" onclick="generateReport()">Generate Report</button>
                <button class="btn" onclick="resetScorecard()">Reset Scorecard</button>
                <button class="btn" onclick="window.print()">Print/Save PDF</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize date to today
        document.getElementById('evaluationDate').value = new Date().toISOString().split('T')[0];

        function updateScore(categoryNum, criterionNum, value) {
            const scoreElement = document.getElementById(`score${categoryNum}-${criterionNum}`);
            const score = parseFloat(value) || 0;
            
            scoreElement.textContent = score.toFixed(1);
            scoreElement.className = 'score-display';
            
            if (score >= 4) scoreElement.classList.add('score-excellent');
            else if (score >= 3) scoreElement.classList.add('score-good');
            else if (score >= 2) scoreElement.classList.add('score-fair');
            else if (score >= 1) scoreElement.classList.add('score-poor');
            
            updateCategoryScore(categoryNum);
            updateOverallScore();
        }

        function updateCategoryScore(categoryNum) {
            const selects = document.querySelectorAll(`select[data-category="${categoryNum}"]`);
            let total = 0;
            let count = 0;
            
            selects.forEach(select => {
                const value = parseFloat(select.value);
                if (value > 0) {
                    total += value;
                    count++;
                }
            });
            
            const average = count > 0 ? total / count : 0;
            const scoreElement = document.getElementById(`category${categoryNum}Score`);
            scoreElement.textContent = average.toFixed(1);
        }

        function updateOverallScore() {
            const categoryScores = [];
            for (let i = 1; i <= 5; i++) {
                const scoreText = document.getElementById(`category${i}Score`).textContent;
                const score = parseFloat(scoreText);
                if (score > 0) categoryScores.push(score);
            }
            
            const overall = categoryScores.length > 0 
                ? categoryScores.reduce((a, b) => a + b, 0) / categoryScores.length 
                : 0;
            
            document.getElementById('overallScore').textContent = overall.toFixed(1);
            
            // Update highest and lowest categories
            if (categoryScores.length > 0) {
                const categoryNames = [
                    'Service Quality',
                    'Cost & Value', 
                    'Compliance',
                    'Communication',
                    'Technology'
                ];
                
                const scores = categoryScores.map((score, index) => ({
                    score: score,
                    name: categoryNames[index]
                }));
                
                scores.sort((a, b) => b.score - a.score);
                
                document.getElementById('highestCategory').textContent = 
                    scores[0].name + ' (' + scores[0].score.toFixed(1) + ')';
                document.getElementById('lowestCategory').textContent = 
                    scores[scores.length - 1].name + ' (' + scores[scores.length - 1].score.toFixed(1) + ')';
            }
        }

        // Add event listeners to all rating selects
        document.addEventListener('DOMContentLoaded', function() {
            const selects = document.querySelectorAll('.rating-select');
            selects.forEach(select => {
                select.addEventListener('change', function() {
                    const category = this.dataset.category;
                    const criterion = this.dataset.criterion;
                    const value = this.value;
                    updateScore(category, criterion, value);
                });
            });
        });

        function generateReport() {
            const vendorName = document.getElementById('vendorName').value || 'Unnamed Vendor';
            const evaluator = document.getElementById('evaluator').value || 'Anonymous';
            const date = document.getElementById('evaluationDate').value || 'Not specified';
            const facilityType = document.getElementById('facilityType').value || 'Not specified';
            const overallScore = document.getElementById('overallScore').textContent;
            const recommendations = document.getElementById('recommendations').value || 'No additional notes provided.';
            
            const report = `
VENDOR PERFORMANCE SCORECARD REPORT
=====================================

Vendor: ${vendorName}
Evaluator: ${evaluator}
Date: ${date}
Facility Type: ${facilityType}

OVERALL SCORE: ${overallScore}/5.0

CATEGORY BREAKDOWN:
- Service Quality & Expertise: ${document.getElementById('category1Score').textContent}/5.0
- Cost & Value: ${document.getElementById('category2Score').textContent}/5.0
- Compliance & Safety: ${document.getElementById('category3Score').textContent}/5.0
- Communication & Reliability: ${document.getElementById('category4Score').textContent}/5.0
- Technology & Innovation: ${document.getElementById('category5Score').textContent}/5.0

RECOMMENDATIONS & NOTES:
${recommendations}

Generated by MedAsset Partners Vendor Performance Scorecard
            `;
            
            // Create and download report file
            const blob = new Blob([report], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `vendor_scorecard_${vendorName.replace(/\s+/g, '_')}_${date}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        function resetScorecard() {
            if (confirm('Are you sure you want to reset all scores? This action cannot be undone.')) {
                // Reset all form inputs
                const inputs = document.querySelectorAll('input, select, textarea');
                inputs.forEach(input => {
                    if (input.type === 'date') {
                        input.value = new Date().toISOString().split('T')[0];
                    } else {
                        input.value = '';
                    }
                });
                
                // Reset all score displays
                const scoreDisplays = document.querySelectorAll('.score-display');
                scoreDisplays.forEach(display => {
                    display.textContent = '0';
                    display.className = 'score-display';
                });
                
                // Reset category scores
                for (let i = 1; i <= 5; i++) {
                    document.getElementById(`category${i}Score`).textContent = '0.0';
                }
                
                // Reset summary
                document.getElementById('overallScore').textContent = '0.0';
                document.getElementById('highestCategory').textContent = '--';
                document.getElementById('lowestCategory').textContent = '--';
            }
        }

        // Print styles
        const style = document.createElement('style');
        style.textContent = `
            @media print {
                body { background: white !important; }
                .container { max-width: none; margin: 0; padding: 0; }
                .btn { display: none; }
                .category { break-inside: avoid; }
                .header { background: #2E86AB !important; -webkit-print-color-adjust: exact; }
                .category-header { background: linear-gradient(135deg, #2E86AB 0%, #A23B72 50%, #F18F01 100%) !important; -webkit-print-color-adjust: exact; }
                .score-excellent { background: #27AE60 !important; -webkit-print-color-adjust: exact; }
                .score-good { background: #F39C12 !important; -webkit-print-color-adjust: exact; }
                .score-fair { background: #F18F01 !important; -webkit-print-color-adjust: exact; }
                .score-poor { background: #E74C3C !important; -webkit-print-color-adjust: exact; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>