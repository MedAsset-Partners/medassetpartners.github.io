<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maintenance Cost Calculator - MedAsset Partners</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .calculator-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2E86AB 0%, #3498db 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M20 20c0 11.046-8.954 20-20 20v-40c11.046 0 20 8.954 20 20zM0 20v20h40V20H0z'/%3E%3C/g%3E%3C/svg%3E");
        }
        
        .header-content {
            position: relative;
            z-index: 2;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .calculator-body {
            padding: 40px;
        }
        
        .input-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
        }
        
        .section-title {
            color: #2E86AB;
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .icon {
            width: 30px;
            height: 30px;
            background: #2E86AB;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .equipment-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .equipment-item {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }
        
        .equipment-item:hover {
            border-color: #2E86AB;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(46, 134, 171, 0.15);
        }
        
        .equipment-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #666;
            font-weight: 500;
        }
        
        .input-group input, .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #2E86AB;
        }
        
        .add-equipment-btn {
            background: linear-gradient(45deg, #2E86AB, #3498db);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
        }
        
        .add-equipment-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(46, 134, 171, 0.3);
        }
        
        .calculate-btn {
            background: linear-gradient(45deg, #F18F01, #ff9500);
            color: white;
            border: none;
            padding: 20px 50px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 30px auto;
            box-shadow: 0 10px 30px rgba(241, 143, 1, 0.3);
        }
        
        .calculate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(241, 143, 1, 0.4);
        }
        
        .results-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 40px;
            margin-top: 30px;
            display: none;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .result-card {
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .result-value {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .result-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .savings-highlight {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            margin-top: 20px;
        }
        
        .savings-highlight .result-value {
            font-size: 3rem;
            color: #fff;
        }
        
        .breakdown-table {
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            overflow: hidden;
            margin-top: 30px;
        }
        
        .breakdown-table table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .breakdown-table th,
        .breakdown-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }
        
        .breakdown-table th {
            background: rgba(255,255,255,0.1);
            font-weight: 600;
        }
        
        .cta-section {
            background: linear-gradient(45deg, #2E86AB, #3498db);
            color: white;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            margin-top: 30px;
        }
        
        .cta-section h3 {
            margin-bottom: 15px;
            font-size: 1.5rem;
        }
        
        .cta-section p {
            margin-bottom: 20px;
            opacity: 0.9;
        }
        
        .cta-btn {
            background: white;
            color: #2E86AB;
            border: none;
            padding: 15px 35px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
        }
        
        .cta-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }
        
        .remove-btn {
            background: #ff4757;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            float: right;
            margin-top: -5px;
        }
        
        .remove-btn:hover {
            background: #ff3742;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .calculator-body {
                padding: 20px;
            }
            
            .equipment-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="calculator-container">
        <div class="header">
            <div class="header-content">
                <h1>Maintenance Cost Calculator</h1>
                <p>Calculate your potential savings by switching from OEM service contracts to third-party maintenance</p>
            </div>
        </div>
        
        <div class="calculator-body">
            <div class="input-section">
                <h2 class="section-title">
                    <div class="icon">1</div>
                    Your Equipment Portfolio
                </h2>
                <div id="equipment-container" class="equipment-grid">
                    <div class="equipment-item">
                        <div class="equipment-name">Equipment #1</div>
                        <div class="input-group">
                            <label>Equipment Type</label>
                            <select class="equipment-type">
                                <option value="">Select Equipment Type</option>
                                <option value="ct">CT Scanner</option>
                                <option value="mri">MRI</option>
                                <option value="xray">X-Ray Machine</option>
                                <option value="ultrasound">Ultrasound</option>
                                <option value="mammography">Mammography</option>
                                <option value="fluoroscopy">Fluoroscopy</option>
                                <option value="carm">C-Arm</option>
                                <option value="dexa">DEXA Scanner</option>
                                <option value="anesthesia">Anesthesia Machine</option>
                                <option value="ventilator">Ventilator</option>
                                <option value="monitor">Patient Monitor</option>
                                <option value="infusion">Infusion Pump</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>Current Annual OEM Contract Cost ($)</label>
                            <input type="number" class="oem-cost" placeholder="25000" min="0">
                        </div>
                        <div class="input-group">
                            <label>Equipment Age (years)</label>
                            <input type="number" class="equipment-age" placeholder="5" min="0" max="30">
                        </div>
                    </div>
                </div>
                <button class="add-equipment-btn" onclick="addEquipment()">+ Add Another Equipment</button>
            </div>
            
            <div class="input-section">
                <h2 class="section-title">
                    <div class="icon">2</div>
                    Practice Information
                </h2>
                <div class="equipment-grid">
                    <div class="equipment-item">
                        <div class="input-group">
                            <label>Practice Type</label>
                            <select id="practice-type">
                                <option value="hospital">Hospital</option>
                                <option value="imaging">Imaging Center</option>
                                <option value="clinic">Medical Clinic</option>
                                <option value="surgery">Surgery Center</option>
                                <option value="cardiology">Cardiology Practice</option>
                                <option value="orthopedic">Orthopedic Practice</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>Average Equipment Downtime Cost per Hour ($)</label>
                            <input type="number" id="downtime-cost" placeholder="500" min="0">
                        </div>
                    </div>
                </div>
            </div>
            
            <button class="calculate-btn" onclick="calculateSavings()">Calculate My Savings</button>
            
            <div id="results" class="results-section">
                <h2 style="text-align: center; margin-bottom: 30px; font-size: 2rem;">Your Potential Savings</h2>
                
                <div class="results-grid">
                    <div class="result-card">
                        <div class="result-value" id="current-cost">$0</div>
                        <div class="result-label">Current Annual OEM Costs</div>
                    </div>
                    <div class="result-card">
                        <div class="result-value" id="third-party-cost">$0</div>
                        <div class="result-label">Estimated Third-Party Costs</div>
                    </div>
                    <div class="result-card">
                        <div class="result-value" id="response-improvement">0%</div>
                        <div class="result-label">Faster Response Time</div>
                    </div>
                </div>
                
                <div class="savings-highlight">
                    <div class="result-value" id="annual-savings">$0</div>
                    <div class="result-label" style="font-size: 1.2rem;">Annual Savings Potential</div>
                </div>
                
                <div class="breakdown-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Equipment</th>
                                <th>Current OEM Cost</th>
                                <th>Third-Party Cost</th>
                                <th>Annual Savings</th>
                            </tr>
                        </thead>
                        <tbody id="breakdown-body">
                        </tbody>
                    </table>
                </div>
                
                <div class="cta-section">
                    <h3>Ready to Start Saving?</h3>
                    <p>Get a personalized quote and see how MedAsset Partners can reduce your maintenance costs while improving service quality.</p>
                    <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap; align-items: center;">
                        <button class="cta-btn" onclick="downloadPDF()">📄 Download Savings Report</button>
                        <button class="cta-btn" onclick="window.open('tel:4808407352', '_self')">📞 Call (480) 840-7352</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        let equipmentCounter = 1;
        let lastCalculationResults = null;
        
        // Equipment-specific savings rates and characteristics
        const equipmentData = {
            ct: { savingsRate: 0.35, name: 'CT Scanner', responseImprovement: 25 },
            mri: { savingsRate: 0.40, name: 'MRI', responseImprovement: 30 },
            xray: { savingsRate: 0.30, name: 'X-Ray Machine', responseImprovement: 20 },
            ultrasound: { savingsRate: 0.25, name: 'Ultrasound', responseImprovement: 15 },
            mammography: { savingsRate: 0.32, name: 'Mammography', responseImprovement: 20 },
            fluoroscopy: { savingsRate: 0.35, name: 'Fluoroscopy', responseImprovement: 25 },
            carm: { savingsRate: 0.30, name: 'C-Arm', responseImprovement: 20 },
            dexa: { savingsRate: 0.28, name: 'DEXA Scanner', responseImprovement: 18 },
            anesthesia: { savingsRate: 0.25, name: 'Anesthesia Machine', responseImprovement: 15 },
            ventilator: { savingsRate: 0.30, name: 'Ventilator', responseImprovement: 20 },
            monitor: { savingsRate: 0.22, name: 'Patient Monitor', responseImprovement: 12 },
            infusion: { savingsRate: 0.20, name: 'Infusion Pump', responseImprovement: 10 },
            other: { savingsRate: 0.28, name: 'Other Equipment', responseImprovement: 18 }
        };
        
        function addEquipment() {
            equipmentCounter++;
            const container = document.getElementById('equipment-container');
            const newEquipment = document.createElement('div');
            newEquipment.className = 'equipment-item';
            newEquipment.innerHTML = `
                <div class="equipment-name">Equipment #${equipmentCounter}</div>
                <button class="remove-btn" onclick="removeEquipment(this)">Remove</button>
                <div class="input-group">
                    <label>Equipment Type</label>
                    <select class="equipment-type">
                        <option value="">Select Equipment Type</option>
                        <option value="ct">CT Scanner</option>
                        <option value="mri">MRI</option>
                        <option value="xray">X-Ray Machine</option>
                        <option value="ultrasound">Ultrasound</option>
                        <option value="mammography">Mammography</option>
                        <option value="fluoroscopy">Fluoroscopy</option>
                        <option value="carm">C-Arm</option>
                        <option value="dexa">DEXA Scanner</option>
                        <option value="anesthesia">Anesthesia Machine</option>
                        <option value="ventilator">Ventilator</option>
                        <option value="monitor">Patient Monitor</option>
                        <option value="infusion">Infusion Pump</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Current Annual OEM Contract Cost ($)</label>
                    <input type="number" class="oem-cost" placeholder="25000" min="0">
                </div>
                <div class="input-group">
                    <label>Equipment Age (years)</label>
                    <input type="number" class="equipment-age" placeholder="5" min="0" max="30">
                </div>
            `;
            container.appendChild(newEquipment);
        }
        
        function removeEquipment(button) {
            button.parentElement.remove();
        }
        
        function calculateSavings() {
            const equipmentItems = document.querySelectorAll('.equipment-item');
            let totalCurrentCost = 0;
            let totalThirdPartyCost = 0;
            let equipmentBreakdown = [];
            let weightedResponseImprovement = 0;
            let totalCostForWeighting = 0;
            let validEquipmentCount = 0;
            
            console.log('Starting calculation with', equipmentItems.length, 'equipment items');
            
            equipmentItems.forEach((item, index) => {
                const typeSelect = item.querySelector('.equipment-type');
                const oemCostInput = item.querySelector('.oem-cost');
                const ageInput = item.querySelector('.equipment-age');
                
                if (!typeSelect || !oemCostInput || !ageInput) {
                    console.log('Missing input fields in equipment item', index);
                    return;
                }
                
                const type = typeSelect.value;
                const oemCost = parseFloat(oemCostInput.value) || 0;
                const age = parseFloat(ageInput.value) || 0;
                
                console.log(`Equipment ${index + 1}: type=${type}, cost=${oemCost}, age=${age}`);
                
                if (type && oemCost > 0) {
                    const equipmentInfo = equipmentData[type];
                    
                    if (!equipmentInfo) {
                        console.log('No equipment data found for type:', type);
                        return;
                    }
                    
                    validEquipmentCount++;
                    
                    // Age factor - older equipment typically has higher savings potential
                    let ageFactor = 1;
                    if (age > 7) ageFactor = 1.1;
                    if (age > 10) ageFactor = 1.15;
                    
                    const savingsRate = Math.min(equipmentInfo.savingsRate * ageFactor, 0.5); // Cap at 50%
                    const savings = oemCost * savingsRate;
                    const thirdPartyCost = oemCost - savings;
                    
                    totalCurrentCost += oemCost;
                    totalThirdPartyCost += thirdPartyCost;
                    
                    // Weight response improvement by equipment cost
                    weightedResponseImprovement += equipmentInfo.responseImprovement * oemCost;
                    totalCostForWeighting += oemCost;
                    
                    equipmentBreakdown.push({
                        name: equipmentInfo.name,
                        currentCost: oemCost,
                        thirdPartyCost: thirdPartyCost,
                        savings: savings
                    });
                    
                    console.log(`Added equipment: ${equipmentInfo.name}, savings: ${savings}`);
                }
            });
            
            console.log(`Valid equipment count: ${validEquipmentCount}, Total current cost: ${totalCurrentCost}`);
            
            if (totalCurrentCost === 0 || validEquipmentCount === 0) {
                alert('Please add at least one equipment with valid type and cost information.');
                return;
            }
            
            const totalSavings = totalCurrentCost - totalThirdPartyCost;
            const avgResponseImprovement = totalCostForWeighting > 0 ? 
                Math.round(weightedResponseImprovement / totalCostForWeighting) : 0;
            
            console.log(`Calculation results: Total savings: ${totalSavings}, Response improvement: ${avgResponseImprovement}%`);
            
            // Display results
            document.getElementById('current-cost').textContent = formatCurrency(totalCurrentCost);
            document.getElementById('third-party-cost').textContent = formatCurrency(totalThirdPartyCost);
            document.getElementById('annual-savings').textContent = formatCurrency(totalSavings);
            document.getElementById('response-improvement').textContent = avgResponseImprovement + '%';
            
            // Display breakdown table
            const breakdownBody = document.getElementById('breakdown-body');
            if (!breakdownBody) {
                console.error('Breakdown table body not found');
                return;
            }
            
            breakdownBody.innerHTML = '';
            
            console.log('Adding', equipmentBreakdown.length, 'rows to breakdown table');
            
            equipmentBreakdown.forEach((item, index) => {
                console.log(`Adding row ${index + 1}: ${item.name}`);
                const row = breakdownBody.insertRow();
                row.insertCell(0).textContent = item.name;
                row.insertCell(1).textContent = formatCurrency(item.currentCost);
                row.insertCell(2).textContent = formatCurrency(item.thirdPartyCost);
                row.insertCell(3).textContent = formatCurrency(item.savings);
            });
            
            console.log('Table populated, showing results section');
            
            // Store results for PDF generation
            lastCalculationResults = {
                totalCurrentCost,
                totalThirdPartyCost,
                totalSavings,
                avgResponseImprovement,
                equipmentBreakdown,
                practiceType: document.getElementById('practice-type')?.value || 'Unknown',
                downtimeCost: document.getElementById('downtime-cost')?.value || '0'
            };
            
            // Show results section
            const resultsSection = document.getElementById('results');
            if (resultsSection) {
                resultsSection.style.display = 'block';
                setTimeout(() => {
                    resultsSection.scrollIntoView({ behavior: 'smooth' });
                }, 100);
            } else {
                console.error('Results section not found');
            }
        }
        
        function downloadPDF() {
            if (!lastCalculationResults) {
                alert('Please calculate your savings first before downloading the report.');
                return;
            }
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Company colors
            const primaryColor = [46, 134, 171]; // #2E86AB
            const accentColor = [241, 143, 1]; // #F18F01
            const textColor = [51, 51, 51]; // #333333
            const lightGray = [248, 249, 250]; // #f8f9fa
            
            // Helper function to format currency
            const formatPDFCurrency = (amount) => {
                return new Intl.NumberFormat('en-US', {
                    style: 'currency',
                    currency: 'USD',
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                }).format(amount);
            };
            
            // Page setup
            let yPosition = 20;
            const pageWidth = doc.internal.pageSize.getWidth();
            const pageHeight = doc.internal.pageSize.getHeight();
            const margin = 20;
            const contentWidth = pageWidth - (margin * 2);
            
            // Header with logo area and company info
            doc.setFillColor(primaryColor[0], primaryColor[1], primaryColor[2]);
            doc.rect(0, 0, pageWidth, 60, 'F');
            
            // Company logo placeholder (medical cross)
            doc.setFillColor(255, 255, 255);
            doc.circle(35, 30, 12, 'F');
            doc.setFillColor(primaryColor[0], primaryColor[1], primaryColor[2]);
            doc.rect(32, 20, 6, 20, 'F'); // Vertical bar
            doc.rect(25, 27, 20, 6, 'F'); // Horizontal bar
            
            // Company name and tagline
            doc.setTextColor(255, 255, 255);
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(24);
            doc.text('MedAsset Partners', 55, 25);
            
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(12);
            doc.text('Medical Equipment Excellence', 55, 35);
            doc.text('Phone: (480) 840-7352 | Email: contact@medassetpartners.com', 55, 45);
            
            // Report title
            yPosition = 80;
            doc.setTextColor(textColor[0], textColor[1], textColor[2]);
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(20);
            doc.text('Equipment Maintenance Savings Analysis', margin, yPosition);
            
            // Generated date
            yPosition += 10;
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(10);
            const today = new Date().toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            doc.text(`Generated on: ${today}`, margin, yPosition);
            
            // Practice information
            yPosition += 20;
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(14);
            doc.text('Practice Information', margin, yPosition);
            
            yPosition += 15;
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(11);
            doc.text(`Practice Type: ${lastCalculationResults.practiceType}`, margin, yPosition);
            yPosition += 8;
            doc.text(`Equipment Downtime Cost: ${lastCalculationResults.downtimeCost}/hour`, margin, yPosition);
            
            // Executive Summary Box
            yPosition += 20;
            doc.setFillColor(lightGray[0], lightGray[1], lightGray[2]);
            doc.rect(margin, yPosition - 5, contentWidth, 45, 'F');
            
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(14);
            doc.setTextColor(primaryColor[0], primaryColor[1], primaryColor[2]);
            doc.text('Executive Summary', margin + 10, yPosition + 5);
            
            doc.setTextColor(textColor[0], textColor[1], textColor[2]);
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(11);
            
            yPosition += 15;
            doc.text(`Current Annual OEM Costs: ${formatPDFCurrency(lastCalculationResults.totalCurrentCost)}`, margin + 10, yPosition);
            yPosition += 8;
            doc.text(`Estimated Third-Party Costs: ${formatPDFCurrency(lastCalculationResults.totalThirdPartyCost)}`, margin + 10, yPosition);
            yPosition += 8;
            
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(12);
            doc.setTextColor(accentColor[0], accentColor[1], accentColor[2]);
            doc.text(`Annual Savings Potential: ${formatPDFCurrency(lastCalculationResults.totalSavings)}`, margin + 10, yPosition);
            
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(11);
            doc.setTextColor(textColor[0], textColor[1], textColor[2]);
            yPosition += 8;
            doc.text(`Average Response Time Improvement: ${lastCalculationResults.avgResponseImprovement}%`, margin + 10, yPosition);
            
            // Equipment Breakdown Table
            yPosition += 30;
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(14);
            doc.text('Equipment Breakdown', margin, yPosition);
            
            yPosition += 15;
            
            // Table headers
            const colWidths = [45, 35, 35, 35];
            const startX = margin;
            let currentX = startX;
            
            // Header background
            doc.setFillColor(primaryColor[0], primaryColor[1], primaryColor[2]);
            doc.rect(startX, yPosition - 5, colWidths.reduce((a, b) => a + b, 0), 12, 'F');
            
            doc.setTextColor(255, 255, 255);
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(10);
            
            doc.text('Equipment', currentX + 2, yPosition + 2);
            currentX += colWidths[0];
            doc.text('Current Cost', currentX + 2, yPosition + 2);
            currentX += colWidths[1];
            doc.text('Third-Party Cost', currentX + 2, yPosition + 2);
            currentX += colWidths[2];
            doc.text('Annual Savings', currentX + 2, yPosition + 2);
            
            yPosition += 12;
            
            // Table rows
            doc.setTextColor(textColor[0], textColor[1], textColor[2]);
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(9);
            
            lastCalculationResults.equipmentBreakdown.forEach((item, index) => {
                // Alternating row colors
                if (index % 2 === 0) {
                    doc.setFillColor(248, 249, 250);
                    doc.rect(startX, yPosition - 3, colWidths.reduce((a, b) => a + b, 0), 10, 'F');
                }
                
                currentX = startX;
                doc.text(item.name, currentX + 2, yPosition + 2);
                currentX += colWidths[0];
                doc.text(formatPDFCurrency(item.currentCost), currentX + 2, yPosition + 2);
                currentX += colWidths[1];
                doc.text(formatPDFCurrency(item.thirdPartyCost), currentX + 2, yPosition + 2);
                currentX += colWidths[2];
                doc.text(formatPDFCurrency(item.savings), currentX + 2, yPosition + 2);
                
                yPosition += 10;
            });
            
            // Benefits section
            yPosition += 20;
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(14);
            doc.text('Key Benefits of Third-Party Maintenance', margin, yPosition);
            
            yPosition += 15;
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(10);
            
            const benefits = [
                '• Significant cost savings (20-50% vs OEM contracts)',
                '• Faster response times and same-day service availability',
                '• Experienced technicians with multi-brand expertise',
                '• Comprehensive compliance documentation and tracking',
                '• Flexible service plans tailored to your needs',
                '• 24/7 emergency support hotline'
            ];
            
            benefits.forEach(benefit => {
                doc.text(benefit, margin, yPosition);
                yPosition += 8;
            });
            
            // Add a new page if needed for the next steps
            if (yPosition > pageHeight - 60) {
                doc.addPage();
                yPosition = 30;
            }
            
            // Next Steps
            yPosition += 20;
            doc.setFillColor(primaryColor[0], primaryColor[1], primaryColor[2]);
            doc.rect(margin, yPosition - 5, contentWidth, 50, 'F');
            
            doc.setTextColor(255, 255, 255);
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(14);
            doc.text('Next Steps', margin + 10, yPosition + 5);
            
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(11);
            yPosition += 15;
            doc.text('1. Schedule a free consultation to discuss your specific needs', margin + 10, yPosition);
            yPosition += 8;
            doc.text('2. Receive a detailed proposal with customized service plans', margin + 10, yPosition);
            yPosition += 8;
            doc.text('3. Begin saving immediately with our professional maintenance services', margin + 10, yPosition);
            yPosition += 8;
            doc.text('Call (480) 840-7352 or email contact@medassetpartners.com', margin + 10, yPosition);
            
            // Footer
            doc.setTextColor(textColor[0], textColor[1], textColor[2]);
            doc.setFont('helvetica', 'italic');
            doc.setFontSize(8);
            doc.text('This analysis is based on industry averages and your provided information. Actual savings may vary.', margin, pageHeight - 20);
            doc.text('© 2025 MedAsset Partners. All rights reserved.', margin, pageHeight - 10);
            
            // Generate filename with date
            const filename = `MedAsset-Savings-Analysis-${new Date().toISOString().split('T')[0]}.pdf`;
            
            // Save the PDF
            doc.save(filename);
        }
        
        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }
        
        // Add some visual feedback for form interactions
        document.addEventListener('DOMContentLoaded', function() {
            // Animate equipment items on load
            const items = document.querySelectorAll('.equipment-item');
            items.forEach((item, index) => {
                item.style.opacity = '0';
                item.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    item.style.transition = 'all 0.5s ease';
                    item.style.opacity = '1';
                    item.style.transform = 'translateY(0)';
                }, index * 100);
            });
        });
    </script>
</body>
</html>